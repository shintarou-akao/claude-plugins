---
name: spec-plan
description: 仕様書から詳細な実装計画を自動生成し、planファイルとして出力する
argument-hint: "path/to/spec.md"
---

# 仕様書からplan自動生成

仕様書のパスを受け取り、その内容を読み取って詳細で実行可能な実装計画を自動生成します。

## 処理手順

### Step 1: 仕様書の読み込み

1. `$ARGUMENTS` で渡されたパスの仕様書を `Read` ツールで読み込む
2. 仕様書の内容から以下を把握する：
   - **目的・要件**: 何を実装するのか
   - **機能仕様**: 具体的な動作・インターフェース
   - **制約・非機能要件**: パフォーマンス、セキュリティなど

### Step 2: コードベースの探索・不明点の確認

コードベースの探索と不明点の確認を行う。

### Step 3: PR単位での計画構成

**重要: 計画はPR単位で構成すること。**

PRの分割基準：

- **独立してレビュー可能**: 各PRは単独でレビュー・マージできる
- **リスク分離**: 破壊的変更は別PRに分離
- **論理的なまとまり**: 関連する変更をグループ化
- **段階的な移行**: 大規模な変更は段階的に分割

PRの粒度：

- **修正の種類ごとに分ける**: 異なる種類の修正は別PRにする
- **1PR = 1種類の修正**: 複数の種類の修正を1つのPRに混ぜない

### Step 4: planファイルの生成

`~/.claude/plan/{仕様書ファイル名（拡張子なし）}.md` に以下の構成でplanファイルを作成：

```markdown
# {仕様書ファイル名}: {仕様書から抽出したタイトル}

## 概要

{仕様書の内容から抽出した要約}

## 背景・目的

{仕様書に記載された目的、または解決する問題}

## 実装方針

{具体的な実装アプローチ、選択した理由}

---

## PR 1: {PRのタイトル}

{このPRの目的・概要を1-2行で説明}

### チェックリスト

- [ ] タスク1の説明
  - 対象: `ファイルパス`
  - 詳細な作業内容

- [ ] タスク2の説明
  - 対象: `ファイルパス1`, `ファイルパス2`
  - 詳細な作業内容

### 検証

Step 2の探索で把握したプロジェクトのビルド・テスト・リント手段に基づき、適切な検証コマンドを記載する。該当するものが見つからない場合は「要確認」と明示する。

（複数PRがある場合は同様の形式で追加）
```

生成したplanファイルの絶対パスを表示する。
